# -*- coding: utf-8 -*-
"""AI automation

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1n2H2UaC8OGjkXlDrPc5_HxvZvnSkPRtD
"""

# ai_automation.py  â† Save with this name
import streamlit as st
import pandas as pd
import numpy as np
import xgboost as xgb
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime

st.set_page_config(page_title="AI Marketing ROI Analyzer", layout="wide")
st.title("AI Marketing Campaign ROI Analyzer")
st.markdown("### Predict ROI & Get Smart Budget Recommendations")

@st.cache_resource
def load_model():
    try:
        model = xgb.XGBRegressor()
        model.load_model("roi_model.json")
        return model
    except:
        return None

model = load_model()

with st.sidebar:
    st.header("Upload Data")
    uploaded_file = st.file_uploader("Drop your CSV here", type=["csv"])
    use_demo = st.checkbox("Or use demo data", value=True)

# Load data
if use_demo or uploaded_file is None:
    try:
        df = pd.read_csv("authentic_ad_data.csv")  # Put this file in your repo!
        st.success("Demo data loaded")
    except:
        st.error("authentic_ad_data.csv not found! Upload your own file.")
        st.stop()
else:
    df = pd.read_csv(uploaded_file)
    st.success(f"Loaded {len(df)} campaigns")

# Clean numeric columns (handles commas, $ signs, etc.)
for col in ['Spend', 'Revenue']:
    df[col] = pd.to_numeric(df[col].astype(str).str.replace('[$,]', '', regex=True), errors='coerce')

# Fill any NaN after cleaning
df[['Spend', 'Revenue']] = df[['Spend', 'Revenue']].fillna(0)

# Metrics
col1, col2, col3, col4 = st.columns(4)
total_spend = df['Spend'].sum()
total_revenue = df['Revenue'].sum()
with col1: st.metric("Campaigns", len(df))
with col2: st.metric("Total Spend", f"${total_spend:,.0f}")
with col3: st.metric("Total Revenue", f"${total_revenue:,.0f}")
with col4:
    roi = (total_revenue - total_spend) / total_spend if total_spend > 0 else 0
    st.metric("Current ROI", f"{roi:.1%}")

st.dataframe(df.head(10))

