# -*- coding: utf-8 -*-
"""AI automation

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1n2H2UaC8OGjkXlDrPc5_HxvZvnSkPRtD
"""

!pip install streamlit
import streamlit as st
import pandas as pd
import numpy as np
import xgboost as xgb
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime

# ========================= CONFIG =========================
st.set_page_config(page_title="AI Marketing ROI Analyzer", layout="wide")
st.title("AI Marketing Campaign ROI Analyzer")
st.markdown("### Predict ROI & Get Smart Budget Recommendations — Built for Startups & Agencies")

# Load pre-trained model (you'll save this after training)
@st.cache_resource
def load_model():
    try:
        model = xgb.XGBRegressor()
        model.load_model("roi_model.json")
        return model
    except:
        st.warning("Model not found. Using demo mode with rule-based predictions.")
        return None

model = load_model()

# ========================= SIDEBAR =========================
with st.sidebar:
    st.header("Settings")
    show_sample_data = st.checkbox("Use built-in sample data (for demo)", value=True)
    st.markdown("---")
    st.info("Upload your own CSV or use the sample to test instantly")

# ========================= DATA LOADING =========================
if show_sample_data:
    # Built-in realistic sample (fallback + great for live demos)
    df = pd.read_csv("/content/lead_generation_csv-sheet1-sourcetable.csv")  # Make sure this file is in your repo!
    st.success("Sample dataset loaded (130+ real-looking campaigns)")
else:
    uploaded_file = st.file_uploader("Upload your campaign data (CSV)", type=["csv"])
    if uploaded_file is not None:
        try:
            df = pd.read_csv(uploaded_file)
            st.success(f"Uploaded: {uploaded_file.name} — {len(df)} campaigns")
        except Exception as e:
            st.error(f"Error: {e}")
            st.stop()
    else:
        st.info("No file uploaded yet. Using sample data for preview...")
        df = pd.read_csv("/content/lead_generation_csv-sheet1-sourcetable.csv")

# Convert 'Spend' and 'Revenue' to numeric, handling commas
df['Spend'] = df['Spend'].astype(str).str.replace(',', '', regex=False).astype(float)
df['Revenue'] = df['Revenue'].astype(str).str.replace(',', '', regex=False).astype(float)

# ========================= BASIC INFO & PREVIEW =========================
col1, col2, col3, col4 = st.columns(4)
with col1:
    st.metric("Total Campaigns", len(df))
with col2:
    st.metric("Total Spend", f"${df['Spend'].sum():,.0f}")
with col3:
    st.metric("Total Revenue", f"${df['Revenue'].sum():,.0f}")
with col4:
    avg_roi = (df['Revenue'].sum() - df['Spend'].sum()) / df['Spend'].sum()
    st.metric("Average ROI", f"{avg_roi:.1%}")